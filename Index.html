<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Pro App</title>

    <link rel="icon" type="image/png" href="logo.png">
    
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js"></script>
    <script src="https://unpkg.com/html5-qrcode"></script>

    <style>
        :root {
            --accent: #00d2ff;
            --success: #2ecc71;
            --bg: #0f172a;
            --card: #1e293b;
            --text-muted: #94a3b8;
            --nav-bg: #1e293b;
        }

        body {
            background: var(--bg);
            color: white;
            font-family: 'Segoe UI', Tahoma, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        /* Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        .app-content {
            width: 100%;
            max-width: 500px;
            padding: 20px;
            padding-bottom: 100px; /* Ù…Ø³Ø§ÙØ© Ø¹Ø´Ø§Ù† Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø³ÙÙ„ÙŠ */
            box-sizing: border-box;
        }

        .header-area { text-align: center; margin-bottom: 25px; margin-top: 10px; }
        .header-area img { width: 50px; height: 50px; border-radius: 10px; }
        h1 { color: var(--accent); font-size: 1.5rem; margin: 10px 0; }

        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø³ÙÙ„ÙŠ */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--nav-bg);
            display: flex;
            justify-content: space-around;
            padding: 12px 0;
            border-top: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 -5px 20px rgba(0,0,0,0.3);
            z-index: 1000;
        }

        .nav-item {
            color: var(--text-muted);
            text-decoration: none;
            font-size: 0.75rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            transition: 0.3s;
            flex: 1;
        }

        .nav-item.active { color: var(--accent); }
        .nav-item svg { width: 24px; height: 24px; margin-bottom: 4px; fill: currentColor; }

        /* Ø§Ù„Ø£Ù‚Ø³Ø§Ù… */
        .page-section { display: none; width: 100%; }
        .page-section.active { display: block; animation: fadeIn 0.4s ease; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Ø³ØªØ§ÙŠÙ„ Ø§Ù„ÙƒØ±ÙˆØª ÙˆØ§Ù„Ù…Ø¯Ø®Ù„Ø§Øª */
        .card {
            background: var(--card);
            border-radius: 20px;
            padding: 20px;
            border: 1px solid rgba(255,255,255,0.05);
            margin-bottom: 20px;
        }

        .control-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 8px; font-size: 0.85rem; color: var(--text-muted); }
        input {
            width: 100%; padding: 12px; border-radius: 12px; border: 2px solid #334155;
            background: #0f172a; color: white; box-sizing: border-box; outline: none;
        }

        .action-btn {
            width: 100%; padding: 15px; border-radius: 12px; border: none;
            background: var(--accent); color: var(--bg); font-weight: bold;
            cursor: pointer; font-size: 1rem; transition: 0.3s;
        }

        #result-area { text-align: center; margin-top: 20px; display: none; }
        canvas { max-width: 100%; border-radius: 15px; background: white; padding: 10px; }

        /* Ù‚Ø³Ù… About & Contact */
        .info-text { line-height: 1.6; color: var(--text-muted); text-align: center; }
        .contact-link {
            display: inline-block; background: #24A1DE; color: white;
            padding: 12px 25px; border-radius: 30px; text-decoration: none;
            font-weight: bold; margin-top: 15px;
        }
    </style>
</head>
<body>

<div class="app-content">
    <div class="header-area">
        <img src="logo.png" alt="Logo" onerror="this.style.display='none'">
        <h1 id="page-title">Ù…Ø§Ø³Ø­ QR</h1>
    </div>

    <div id="scan-page" class="page-section active">
        <div class="card">
            <div id="reader"></div>
            <div id="camera-prompt" style="text-align: center; padding: 20px;">
                <button class="action-btn" onclick="initScanner()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø³Ø­ Ø§Ù„Ø¢Ù† ğŸ“·</button>
            </div>
            <div id="scan-result-card" style="display:none; text-align:center; margin-top:15px;">
                <p>Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ÙƒØªØ´Ù:</p>
                <a id="result-link" href="#" target="_blank" style="color:var(--accent); word-break:break-all;"></a>
                <button class="action-btn" style="background:#475569; margin-top:15px;" onclick="resetScanner()">Ù…Ø³Ø­ Ø¬Ø¯ÙŠØ¯ ğŸ”„</button>
            </div>
        </div>
    </div>

    <div id="create-page" class="page-section">
        <div class="card">
            <div class="control-group">
                <label>Ø§Ù„Ø±Ø§Ø¨Ø· Ø£Ùˆ Ø§Ù„Ù†Øµ</label>
                <input type="text" id="qr-input" placeholder="https://...">
            </div>
            <div style="display: flex; gap:10px; margin-bottom:15px;">
                <div style="flex:1"><label>Ø§Ù„Ø¹Ø±Ø¶</label><input type="number" id="qr-width" value="500"></div>
                <div style="flex:1"><label>Ø§Ù„Ø·ÙˆÙ„</label><input type="number" id="qr-height" value="500"></div>
            </div>
            <div class="control-group">
                <label>Ù†Øµ Ø£Ø³ÙÙ„ Ø§Ù„ÙƒÙˆØ¯ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                <input type="text" id="qr-text" placeholder="Ù…Ø«Ø§Ù„: SCAN ME">
            </div>
            <button class="action-btn" onclick="generateNow()">Ø¥Ù†Ø´Ø§Ø¡ ÙˆØªØ­Ù…ÙŠÙ„ âœ¨</button>
            
            <div id="result-area">
                <canvas id="final-canvas"></canvas>
                <button class="action-btn" style="background:var(--success); margin-top:10px;" onclick="downloadImage()">Ø­ÙØ¸ ÙÙŠ Ø§Ù„Ø¬Ù‡Ø§Ø² â¬‡ï¸</button>
            </div>
        </div>
    </div>

    <div id="about-page" class="page-section">
        <div class="card">
            <h2 style="text-align:center; color:var(--accent)">Ù…Ù† Ù†Ø­Ù†</h2>
            <p class="info-text">
                Ù†Ø­Ù† ÙØ±ÙŠÙ‚ Ù…ØªØ®ØµØµ ÙÙŠ ØªØ·ÙˆÙŠØ± Ø­Ù„ÙˆÙ„ Ø§Ù„ÙˆÙŠØ¨ØŒ Ù‚Ù…Ù†Ø§ Ø¨Ø¨Ù†Ø§Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ù€ Web App Ù„ØªÙˆÙÙŠØ± ØªØ¬Ø±Ø¨Ø© Ø³Ù‡Ù„Ø© ÙˆØ³Ø±ÙŠØ¹Ø© Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù€ QR Code Ø³ÙˆØ§Ø¡ ÙÙŠ Ø§Ù„ØµÙ†Ø§Ø¹Ø© Ø£Ùˆ Ø§Ù„Ù…Ø³Ø­ Ø¨Ø£Ø¹Ù„Ù‰ Ø¬ÙˆØ¯Ø© Ù…Ù…ÙƒÙ†Ø©.
            </p>
        </div>
    </div>

    <div id="contact-page" class="page-section">
        <div class="card" style="text-align: center;">
            <h2 style="color:var(--accent)">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</h2>
            <p class="info-text">Ù„Ø¯ÙŠÙƒ Ø§Ø³ØªÙØ³Ø§Ø± Ø£Ùˆ Ø§Ù‚ØªØ±Ø§Ø­ØŸ Ù†Ø­Ù† Ù‡Ù†Ø§ Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©!</p>
            <a href="https://t.me/Tawaslen" target="_blank" class="contact-link">
                ØªÙˆØ§ØµÙ„ Ø¹Ø¨Ø± ØªÙ„ÙŠØ¬Ø±Ø§Ù… @Tawaslen
            </a>
        </div>
    </div>
</div>

<nav class="bottom-nav">
    <div class="nav-item active" onclick="showPage('scan', 'Ù…Ø§Ø³Ø­ QR', this)">
        <svg viewBox="0 0 24 24"><path d="M4,4H10V10H4V4M14,4H20V10H14V4M14,14H20V20H14V14M4,14H10V20H4V14M6,6V8H8V6H6M16,6V8H18V6H16M16,16V18H18V16H16M6,16V18H8V16H6M7,7V7H7V7H7M17,7V7H17V7H17M17,17V17H17V17H17M7,17V17H7V7H7Z"/></svg>
        <span>Scan</span>
    </div>
    <div class="nav-item" onclick="showPage('create', 'Ø¥Ù†Ø´Ø§Ø¡ QR', this)">
        <svg viewBox="0 0 24 24"><path d="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"/></svg>
        <span>Create</span>
    </div>
    <div class="nav-item" onclick="showPage('about', 'Ù…Ù† Ù†Ø­Ù†', this)">
        <svg viewBox="0 0 24 24"><path d="M12,2C6.48,2,2,6.48,2,12s4.48,10,10,10s10-4.48,10-10S17.52,2,12,2z M13,17h-2v-6h2V17z M13,9h-2V7h2V9z"/></svg>
        <span>About</span>
    </div>
    <div class="nav-item" onclick="showPage('contact', 'ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§', this)">
        <svg viewBox="0 0 24 24"><path d="M20,4H4C2.9,4,2,4.9,2,6v12c0,1.1,0.9,2,2,2h16c1.1,0,2-0.9,2-2V6C22,4.9,21.1,4,20,4z M20,18H4V8l8,5l8-5V18z M12,11L4,6h16L12,11z"/></svg>
        <span>Contact</span>
    </div>
</nav>

<script>
    // ÙˆØ¸ÙŠÙØ© Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„ØµÙØ­Ø§Øª
    function showPage(pageId, title, element) {
        document.querySelectorAll('.page-section').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        
        document.getElementById(pageId + '-page').classList.add('active');
        document.getElementById('page-title').innerText = title;
        element.classList.add('active');

        if(pageId !== 'scan') stopScanner();
    }

    // --- ÙƒÙˆØ¯ Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ ---
    async function generateNow() {
        const text = document.getElementById('qr-input').value;
        const extraText = document.getElementById('qr-text').value;
        const w = parseInt(document.getElementById('qr-width').value) || 500;
        const h = parseInt(document.getElementById('qr-height').value) || 500;
        const canvas = document.getElementById('final-canvas');

        if (!text) return alert("Ø¨Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ù†Øµ");

        try {
            const tempCanvas = document.createElement('canvas');
            const qrSize = Math.min(w, h);
            await QRCode.toCanvas(tempCanvas, text, { width: qrSize, margin: 2, errorCorrectionLevel: 'H' });

            const ctx = canvas.getContext('2d');
            canvas.width = w;
            canvas.height = extraText ? h + 80 : h;
            ctx.fillStyle = "white";
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.drawImage(tempCanvas, (w-qrSize)/2, (h-qrSize)/2);

            if (extraText) {
                ctx.fillStyle = "black";
                ctx.font = "bold 30px Arial";
                ctx.textAlign = "center";
                ctx.fillText(extraText, w/2, h + 40);
            }
            document.getElementById('result-area').style.display = 'block';
        } catch (err) { console.error(err); }
    }

    function downloadImage() {
        const link = document.createElement('a');
        link.download = 'QR_Code.png';
        link.href = document.getElementById('final-canvas').toDataURL();
        link.click();
    }

    // --- ÙƒÙˆØ¯ Ø§Ù„Ù…Ø§Ø³Ø­ ---
    let html5QrCode;
    function initScanner() {
        document.getElementById('camera-prompt').style.display = 'none';
        document.getElementById('reader').style.display = 'block';
        html5QrCode = new Html5Qrcode("reader");
        html5QrCode.start({ facingMode: "environment" }, { fps: 10, qrbox: 250 }, (decodedText) => {
            stopScanner();
            document.getElementById('reader').style.display = 'none';
            document.getElementById('scan-result-card').style.display = 'block';
            document.getElementById('result-link').innerText = decodedText;
            document.getElementById('result-link').href = decodedText.startsWith('http') ? decodedText : 'https://' + decodedText;
        });
    }

    function stopScanner() { if(html5QrCode && html5QrCode.isScanning) html5QrCode.stop(); }
    function resetScanner() { 
        stopScanner(); 
        document.getElementById('scan-result-card').style.display = 'none'; 
        document.getElementById('camera-prompt').style.display = 'block'; 
    }
</script>

</body>
</html>
